<!DOCTYPE html>
<html lang="en">
<!--
  $TREATZ ‚Äî ‚ÄúWhitepaper‚Äù Jump Scare (v3 tweaks)

  QUICK CONFIG (edit on <body>):
    data-halloween-iso   - Countdown target
    data-cta-coinflip    - CTA link to coin flip
    data-cta-jackpot     - CTA link to jackpot
    data-bg-src          - Background image path (e.g., assets/bg_spooky.jpg)
    data-scream-src      - Jump-scare scream SFX
    data-ambient-src     - Eerie background loop
    data-use-emojis      - "true" emojis | "false" PNG/SVGs
    data-sfx-ghost/bat/ghoul/zombie - Per-flyer SFX
    data-run-seconds     - How long flyers+SFX run before stopping (default 5s)
-->
<head>
  <!-- ========== META / TITLE ========== -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>$TREATZ ‚Äî ‚ÄúWhitepaper‚Äù</title>

  <!-- ========== FONTS & BASE STYLES ========== -->
  <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Rubik:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css?v=15" />

  <!-- ========== PAGE-SPECIFIC STYLES ========== -->
  <style>
    /* -------------------------
       1) BASE LAYOUT
    --------------------------*/
    body{
      margin:0; color:var(--white);
      background:linear-gradient(180deg,var(--bg-a),var(--bg-b));
      font-family:Rubik,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      overflow:hidden;
    }

    /* Background image layer */
    .bgimg{
      position:fixed; inset:0; z-index:-2;
      background:#000 center/cover no-repeat;
      filter: saturate(1.05) brightness(.9);
      opacity:.85;
    }
    /* Brand fog overlay */
    .bgfx{
      position:fixed; inset:-10%; z-index:-1;
      background:
        radial-gradient(1200px 600px at 20% 10%, rgba(106,0,255,.22), transparent 60%),
        radial-gradient(900px 500px at 80% 70%, rgba(0,255,163,.16), transparent 55%);
      pointer-events:none;
    }

    /* Countdown */
    .countdown{position:sticky; top:0; z-index:1000; background:linear-gradient(90deg, rgba(255,107,0,.92), rgba(106,0,255,.92)); border-bottom:1px solid rgba(255,255,255,.2)}
    .countdown__inner{max-width:1200px; margin:0 auto; padding:.55rem .9rem; display:flex; gap:.75rem; align-items:center; justify-content:center; flex-wrap:wrap}
    .countdown__label{font-weight:700; letter-spacing:.3px}
    .countdown__timer{font-family:"Luckiest Guy", cursive; font-size:1.25rem; padding:0 .25rem}
    .countdown__omen{font-size:.95rem; opacity:.9}

    /* Stage + Card (hidden until start) */
    .stage{ position:fixed; inset:0; display:grid; place-items:center; pointer-events:none; }
    .cardy{
      pointer-events:auto;
      max-width:860px; margin:6vh auto 10vh; padding:28px;
      background:linear-gradient(180deg, rgba(13,13,13,.90), rgba(13,13,13,.62));
      border:1px solid var(--card-border); border-radius:18px; box-shadow:var(--shadow);
      text-align:center; position:relative; z-index:10;
      opacity:0; transform:translateY(12px); transition:opacity .5s ease, transform .5s ease;
    }
    .cardy.show{ opacity:1; transform:translateY(0); }

    /* Headline */
    .boo{
      font-family:"Luckiest Guy",cursive;
      font-size:clamp(42px,10vw,128px); line-height:.9;
      color:var(--orange);
      text-shadow:
        0 0 6px rgba(255,149,0,.45),
        0 0 16px rgba(106,0,255,.45),
        0 4px 0 rgba(0,0,0,.45);
      transform:scale(.98); opacity:0;
      transition:opacity .9s ease, transform .9s cubic-bezier(.2,.7,.2,1);
      user-select:none;
    }
    .boo.show{ opacity:1; transform:scale(1); }

    /* Punchier subline */
    .sub{
      margin:12px auto 10px;
      font-family:"Luckiest Guy", cursive;
      font-size:clamp(18px,3.2vw,32px);
      letter-spacing:.5px;
      color:#fff;
      text-shadow:
        0 0 14px rgba(0,255,163,.55),
        0 0 24px rgba(106,0,255,.35),
        0 2px 0 rgba(0,0,0,.65);
    }

    /* Copy */
    .explain{
      margin:14px auto 0; max-width:740px; text-align:left;
      opacity:0; transition:opacity 1.2s ease 250ms;
    }
    .explain.show{opacity:1;}
    .explain ul{margin:.6rem 0 .2rem 1.1rem;}
    .explain li{margin:.25rem 0;}
    .explain em{color:#94DAFF; font-style:normal; font-weight:700}

    /* CTA Buttons */
    .cta{ margin-top:18px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap; }
    .btn{cursor:pointer; border:none; padding:.9rem 1.25rem; border-radius:16px; font-weight:900;}
    .btn--primary{background:linear-gradient(180deg,var(--orange),var(--orange-hi)); color:#1a0b00}
    .btn--outline{background:transparent; color:var(--white); border:1px solid var(--white); opacity:.95}
    .muted{opacity:.85; font-size:.9rem; margin-top:8px; text-align:center;}

    /* Veil (keep page hidden until click) */
    .veil{
      position:fixed; inset:0; display:grid; place-items:center; z-index:20;
      background:rgba(9,9,9,.72); backdrop-filter:blur(6px);
    }
    .veil__card{
      background:linear-gradient(180deg, rgba(13,13,13,.95), rgba(13,13,13,.78));
      border:1px solid var(--card-border); padding:22px 26px; border-radius:18px; text-align:center;
      box-shadow:var(--shadow); max-width:520px;
    }
    .veil__title{
      font-family:"Luckiest Guy"; font-size:clamp(20px,3.4vw,34px);
      margin:0 0 10px; color:var(--orange);
      text-shadow:0 0 14px rgba(255,149,0,.4), 0 0 22px rgba(106,0,255,.4);
    }
    .veil__btn{
      margin-top:14px; font-size:clamp(18px,2.6vw,24px);
      padding:1rem 1.5rem; border-radius:18px;
      background:linear-gradient(180deg,var(--orange),var(--orange-hi));
      color:#1a0b00; font-weight:900; border:none; cursor:pointer;
      box-shadow:0 10px 30px rgba(0,0,0,.45);
    }
    .veil__btn:hover{ transform:translateY(-1px); }

    /* Flyers */
    .flyer{
      position:fixed;
      transform:scale(.2);
      filter:drop-shadow(0 8px 24px rgba(0,0,0,.55));
      opacity:0; pointer-events:none; z-index:5;
      will-change:transform, opacity, filter;
      animation:swoop 1.2s cubic-bezier(.2,.6,.2,1) forwards;
    }
    .flyer--ghost{ font-size:80px; text-shadow:0 0 18px rgba(148,218,255,.6); }
    .flyer--bat  { font-size:56px; text-shadow:0 0 14px rgba(255,255,255,.25); }
    .flyer--ghoul{ font-size:84px; text-shadow:0 0 18px rgba(106,0,255,.45); color:#bba0ff; }
    .flyer--zomb { font-size:84px; text-shadow:0 0 18px rgba(0,255,163,.35); color:#b6ffd9; }

    @keyframes swoop{
      0%{opacity:0; transform:scale(.2) rotate(0deg);}
      5%{opacity:1;}
      80%{opacity:1; filter:blur(0px);}
      100%{opacity:0; transform:scale(6) rotate(3deg); filter:blur(4px);}
    }

    @media (prefers-reduced-motion: reduce){
      .flyer{animation:none; opacity:.85; transform:scale(1);}
    }
  </style>
</head>

<body
  id="page"
  data-halloween-iso="2025-10-31T00:00:00-04:00"
  data-cta-coinflip="index.html#coin-flip"
  data-cta-jackpot="index.html#jackpot"
  data-bg-src="assets/background2.png"
  data-scream-src="assets/scream.mp3"
  data-ambient-src="assets/ambient_loop.mp3"
  data-use-emojis="true"
  data-sfx-ghost="assets/sfx_ghost.mp3"
  data-sfx-bat="assets/sfx_bat.mp3"
  data-sfx-ghoul="assets/sfx_ghoul.mp3"
  data-sfx-zombie="assets/sfx_zombie.mp3"
  data-run-seconds="5"
>
  <!-- A) COUNTDOWN -->
  <header class="countdown" id="countdown" role="banner" aria-label="Halloween Countdown">
    <div class="countdown__inner">
      <span class="countdown__label">‚è≥ Countdown to Halloween:</span>
      <span class="countdown__timer" id="countdown-timer">--d --h --m --s</span>
      <span class="countdown__omen" id="countdown-omen" aria-live="polite"></span>
    </div>
  </header>

  <!-- B) BACKGROUND LAYERS -->
  <div class="bgimg" id="bgimg" aria-hidden="true"></div>
  <div class="bgfx"  aria-hidden="true"></div>

  <!-- C) MAIN CONTENT (hidden until click) -->
  <main class="stage" role="main">
    <section class="cardy" id="cardy" aria-live="polite">
      <h1 class="boo" id="boo" aria-label="Boo! Jump Scare">üëª BOO! üëª</h1>

      <p class="sub">You expected a whitepaper. You got a fright-paper.</p>

      <div class="explain" id="explain">
        <h2 style="margin:.2rem 0 .4rem">Why no ‚Äúwhitepaper‚Äù?</h2>
        <p><strong>Because it‚Äôs Halloween</strong>‚Äîand because <strong>$TREATZ</strong> is simple, on-chain, and player-driven:</p>
        <ul>
          <li>üéÉ <em>Trick or Treat Coin Toss</em> ‚Äî Pick TRICK or TREAT, send your wager, find your fate.</li>
          <li>üïØÔ∏è <em>Jackpot Raffle</em> ‚Äî 80% winner ‚Ä¢ 10% burned ‚Ä¢ 10% dev. Pots glow, chains know.</li>
          <li>üí® <strong>Grab a bag and play now</strong> ‚Äî fill it with candy‚Ä¶ and wins.</li>
        </ul>
        <p><strong>The chain is the proof.</strong> The code is the contract. The community lights the lanterns.</p>

        <div class="cta" id="cta">
          <a class="btn btn--primary" id="cta-coinflip" href="#">Play Trick or Treat</a>
          <a class="btn btn--outline" id="cta-jackpot"  href="#">Enter the Jackpot</a>
        </div>
        <p class="muted">Want docs later? We‚Äôll post a short overview‚Äîbut for now, follow the lanterns and play.</p>
      </div>
    </section>
  </main>

  <!-- D) VEIL (keeps page hidden + unlocks audio) -->
  <div class="veil" id="veil" role="dialog" aria-modal="true" aria-labelledby="veil-title">
    <div class="veil__card">
      <h2 class="veil__title" id="veil-title">A Warning from the Puff</h2>
      <p>Only the brave may proceed.</p>
      <button class="veil__btn" id="begin">Read the Whitepaper if you Dare</button>
    </div>
  </div>

  <!-- E) AUDIO -->
  <audio id="scream" preload="auto"></audio>
  <audio id="ambient" preload="auto" loop></audio>

  <!-- ========== SCRIPTS ========== -->
  <script>
    /* 1) UTILS & CONFIG */
    const $      = (sel, ctx=document) => ctx.querySelector(sel);
    const pageEl = $('#page');
    const CFG = {
      halloweenISO: pageEl.dataset.halloweenIso || '2025-10-31T00:00:00-04:00',
      ctaCoinflip : pageEl.dataset.ctaCoinflip  || 'index.html#coin-flip',
      ctaJackpot  : pageEl.dataset.ctaJackpot   || 'index.html#jackpot',
      bgSrc       : pageEl.dataset.bgSrc        || '',
      screamSrc   : pageEl.dataset.screamSrc    || 'assets/scream.mp3',
      ambientSrc  : pageEl.dataset.ambientSrc   || 'assets/ambient_loop.mp3',
      useEmojis   : (pageEl.dataset.useEmojis || 'true').toLowerCase() === 'true',
      sfx: {
        ghost : pageEl.dataset.sfxGhost  || 'assets/sfx_ghost.mp3',
        bat   : pageEl.dataset.sfxBat    || 'assets/sfx_bat.mp3',
        ghoul : pageEl.dataset.sfxGhoul  || 'assets/sfx_ghoul.mp3',
        zombie: pageEl.dataset.sfxZombie || 'assets/sfx_zombie.mp3',
      },
      runSeconds  : Math.max(1, parseInt(pageEl.dataset.runSeconds || '5',10))
    };

    /* 2) COUNTDOWN */
    (function countdown(){
      const target  = new Date(CFG.halloweenISO);
      const timerEl = $('#countdown-timer');
      const omenEl  = $('#countdown-omen');
      const omens   = [
        'Gremlin in the mempool spotted.',
        'Witches brewing liquidity‚Ä¶',
        'Ghosts front-running paper hands.',
        'Pumpkins aligned. Candles lit.',
        'Never fade the night shift.',
        'Trick? Treat? Only the chain knows.',
        'Beware the spooky slippage.'
      ];
      function tick(){
        const now = new Date();
        const diff = Math.max(0, target - now);
        const s = Math.floor(diff/1000);
        const d = Math.floor(s/86400);
        const h = Math.floor((s%86400)/3600);
        const m = Math.floor((s%3600)/60);
        const sec = s%60;
        timerEl.textContent = `${d}d ${h}h ${m}m ${sec}s`;
        if (Math.random() < 0.01)      omenEl.textContent = '??? A strange puff passes by‚Ä¶';
        else if (sec % 10 === 0)       omenEl.textContent = omens[Math.floor(Math.random()*omens.length)];
      }
      tick(); setInterval(tick, 1000);
    })();

    /* 3) CTA WIRING + BG IMAGE */
    $('#cta-coinflip').href = CFG.ctaCoinflip;
    $('#cta-jackpot').href  = CFG.ctaJackpot;
    if (CFG.bgSrc) { $('#bgimg').style.backgroundImage = `url('${CFG.bgSrc}')`; }

    /* 4) AUDIO INIT (scream -> ambient fade-in) */
    const scream  = $('#scream');  scream.src  = CFG.screamSrc;
    const ambient = $('#ambient'); ambient.src = CFG.ambientSrc; ambient.volume = 0;

    function fadeInAmbient(durationMs=1800, targetVol=0.18){
      const steps = 18, step = targetVol/steps, dt = Math.max(50, Math.floor(durationMs/steps));
      let v = 0;
      const t = setInterval(()=>{
        v = Math.min(targetVol, v + step);
        ambient.volume = v;
        if (v >= targetVol) clearInterval(t);
      }, dt);
    }

    /* 5) FLYERS + UNIQUE SFX + RANDOM SPAWN (auto-stop) */
    const EMOJIS = ['üëª','ü¶á','üßü','üßü‚Äç‚ôÄÔ∏è','üßü‚Äç‚ôÇÔ∏è','üßå'];
    const IMGS   = [
      // { src: 'assets/ghost.png', cls: 'flyer flyer--ghost', size: 96, type:'ghost' },
      // { src: 'assets/bat.png',   cls: 'flyer flyer--bat',   size: 72, type:'bat'   },
      // { src: 'assets/ghoul.png', cls: 'flyer flyer--ghoul', size:104, type:'ghoul' },
      // { src: 'assets/zombie.png',cls: 'flyer flyer--zomb',  size:104, type:'zombie'},
    ];

    const SFX = { ghost: CFG.sfx.ghost, bat: CFG.sfx.bat, ghoul: CFG.sfx.ghoul, zombie: CFG.sfx.zombie };

    function playSfx(kind){
      const src = SFX[kind];
      if (!src) return;
      try {
        const a = new Audio(src);
        a.volume = 0.55;
        a.play().catch(()=>{});
      } catch(e){}
    }

    function randomPos(){
      const w = window.innerWidth, h = window.innerHeight;
      const marginX = Math.max(24, w * 0.06);
      const marginY = Math.max(24, h * 0.06);
      const x = Math.random() * (w - marginX*2) + marginX;
      const y = Math.random() * (h - marginY*2) + marginY;
      return { x, y };
    }

    let runFlyers = false;
    let keepAliveInterval = null;

    function spawnFlyer(){
      if (!runFlyers) return;
      let el, type = 'ghoul';
      if (CFG.useEmojis){
        el = document.createElement('div');
        el.className = 'flyer';
        const pick = EMOJIS[Math.floor(Math.random()*EMOJIS.length)];
        el.textContent = pick;
        if (pick === 'üëª'){ el.classList.add('flyer--ghost'); type='ghost'; }
        else if (pick === 'ü¶á'){ el.classList.add('flyer--bat'); type='bat'; }
        else if (pick.startsWith('üßü')){ el.classList.add('flyer--zomb'); type='zombie'; }
        else { el.classList.add('flyer--ghoul'); type='ghoul'; }
      } else {
        const pick = IMGS[Math.floor(Math.random()*IMGS.length)];
        el = document.createElement('img');
        el.src = pick.src; el.alt = 'spook';
        el.className = pick.cls || 'flyer';
        el.style.width = (pick.size || 96) + 'px';
        type = pick.type || 'ghoul';
      }
      const {x,y} = randomPos();
      el.style.left = x + 'px';
      el.style.top  = y + 'px';
      document.body.appendChild(el);
      playSfx(type);
      el.addEventListener('animationend', ()=> el.remove());
    }

    function burst(count=10, spreadMs=420){
      if (!runFlyers) return;
      let i = 0;
      const t = setInterval(()=>{
        if (!runFlyers) { clearInterval(t); return; }
        spawnFlyer();
        if (++i >= count) clearInterval(t);
      }, Math.max(40, Math.floor(spreadMs/count)));
    }

    function stopFlyersAndSfx(){
      runFlyers = false;
      if (keepAliveInterval) { clearInterval(keepAliveInterval); keepAliveInterval = null; }
      // Flyers already on screen will auto-remove at animationend; no new SFX will play.
    }

    /* 6) JUMP-SCARE SEQUENCE + HIDE/SHOW CONTENT */
    const veil  = $('#veil');
    const begin = $('#begin');
    const booEl = $('#boo');
    const txtEl = $('#explain');
    const cardy = $('#cardy');

    async function startShow(){
      // Show card container now (but headline/paragraph still animate)
      cardy.classList.add('show');

      // Jump-scare scream
      try { scream.currentTime = 0; await scream.play(); } catch(e){}

      // Reveal headline + flyer burst
      requestAnimationFrame(()=> booEl.classList.add('show'));
      runFlyers = true;
      burst(18, 560);
      setTimeout(()=> txtEl.classList.add('show'), 800);

      // Ambient loop fades in after scream
      const startAmbient = async()=>{
        try { await ambient.play(); fadeInAmbient(1800, 0.18); } catch(e){}
      };
      if ('onended' in scream){ scream.onended = startAmbient; } else { setTimeout(startAmbient, 1200); }

      // Keep a few flyers coming‚Ä¶ then stop after runSeconds
      keepAliveInterval = setInterval(()=> burst(3, 220), 1400);
      setTimeout(stopFlyersAndSfx, CFG.runSeconds * 1000);
    }

    begin.addEventListener('click', ()=>{
      veil.remove();     // unlock page + audio
      startShow();       // run the sequence
    });
    document.addEventListener('keydown', (e)=>{ if ($('#veil') && e.key === 'Enter') begin.click(); });
  </script>
</body>
</html>
