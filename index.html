<!DOCTYPE html>
<html lang="en">
<head>
  <!-- ========== META ========== -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>$TREATZ ‚Äî The Sweetest Halloween Meme Coin on Solana</title>
  <meta name="description" content="$TREATZ ‚Äî Trick-or-Treat coin toss & Jackpot Raffle. Spooky season on Solana." />
  <meta name="theme-color" content="#0D0D0D" />

  <!-- ========== FONTS ========== -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Rubik:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Creepster&display=swap" rel="stylesheet">

  <!-- ========== CSS ========== -->
  <link id="treatz-css" rel="stylesheet" href="style.css?v={{ site.github.build_revision }}">

  <!-- ========== CONFIG (must be before app.js) ========== -->
  <script>
    window.TREATZ_CONFIG = {
      apiBase: "https://treatz-de1d.onrender.com/api",
      rpcUrl:  "https://mainnet.helius-rpc.com/?api-key=YOUR_KEY",
      token: { symbol: "$TREATZ", decimals: 6 },
      links: {
        telegram: "https://t.me/trickortreatsol",
        twitter:  "https://x.com/trickortreatsol?s=21",
        whitepaper: "https://trickortreatsol.tech/whitepaper"
      },
      buyUrl: "#",
      tokenAddress: "4EyHCxM2ZzHcNBRVCoFwb69rx3V62rQagMrU9dLwpump",
      assets: { logo: "assets/TREATZ_Logo.png", mascot: "assets/Mascot.png" }
    };
  </script>
  <script>
    window.TREATZ_BUILD = "__BUILD__";
  </script>

  <!-- ========== Solana libs (needed by app.js) ========== -->
  <script src="https://unpkg.com/@solana/web3.js@1.95.7/lib/index.iife.min.js"></script>
  <script src="https://unpkg.com/@solana/spl-token@0.4.7/dist/index.iife.js"></script>

  <!-- ========== Loader: inserts app.js with ?v=<build> ========== -->
  <script>
    (function(b){
      var l=document.getElementById('treatz-css');
      if (l && !/\?v=/.test(l.href)) l.href='style.css?v='+b;
      var s=document.createElement('script'); s.defer=true; s.src='app.js?v='+b;
      document.head.appendChild(s);
    })(window.TREATZ_BUILD || Date.now());
  </script>
  <!-- Optional: favicon -->
  <!-- <link rel="icon" href="assets/favicon.png"> -->
</head>
<body>

  <audio id="bg-ambient" src="assets/ambient_loop.mp3" preload="auto" loop></audio>

  <!-- ==========================
     TOP BANNER (sticky)
     ========================== -->
  <div class="brand-banner">
    <img src="assets/Banner_Top.png" alt="$TREATZ banner" />
  </div>

  <!-- ==========================
      GLOBAL COUNTDOWN
      ========================== -->
  <div class="countdown" id="countdown" aria-live="polite">
    <div class="countdown__inner">
      <img id="countdown-logo" class="countdown__logo" src="assets/TREATZ_Logo.png" alt="$TREATZ logo" />
      <span class="countdown__label">Countdown to Halloween:</span>
      <span class="countdown__timer" id="countdown-timer">--d --h --m --s</span>
      <span class="countdown__omen" id="countdown-omen"></span>
    </div>
  </div>

  <!-- =======================================
       NAVIGATION + TOKEN / BUY ACTION BAR
       ======================================= -->
  <header class="nav">
    <div class="nav__wrap">
      <a href="/" class="nav__brand">
        <span class="nav__brand-text">$TREATZ - Own Uptober. Hold the bag. üç¨</span>
      </a>

      <nav class="nav__links" aria-label="Primary">
        <a href="#" id="link-twitter"   target="_blank" rel="noopener">Twitter</a>
        <a href="#" id="link-telegram"  data-live="false" target="_blank" rel="noopener">Telegram</a>
        <a href="https://trickortreatsol.tech/whitepaper" id="link-whitepaper" target="_blank" rel="noopener">Whitepaper</a>
      </nav>
    </div>

    <div class="tokenbar" role="group" aria-label="Token & Buy">
      <div class="tokenbar__address">
        <span class="tokenbar__label">Token:</span>
        <code id="token-address">‚Äî</code>
        <button class="btn btn--ghost" id="btn-copy">Copy</button>
      </div>
      <div class="tokenbar__actions">
        <a class="btn btn--buy" id="btn-buy" href="#" target="_blank" rel="noopener">Buy on Pump.fun</a>
      </div>
    </div>
  </header>

  <!-- ==========================
       BACKGROUND ART LAYER
       ========================== -->
  <div class="bg" role="img" aria-label="Spooky cosmic candy background"></div>

  <!-- ==========================
       MAIN CONTENT
       ========================== -->
  <main class="main">

    <!-- ============= COIN FLIP ============= -->
    <section class="section" id="coin-flip" aria-labelledby="coinflip-title">
      <h2 class="section__title" id="coinflip-title">üéÉ Trickz or $TREATZ ‚Äî Coin Toss</h2>
      <div class="ticker" id="fomo-ticker" aria-live="polite"></div>
      <div class="card grid-2">
        <!-- Form -->
        <div class="card__col">
          <!-- Inline wallet controls for the game area -->
          <div class="wallet wallet--inline">
            <button class="btn btn--ghost"   id="btn-openwallet" type="button" hidden>Open Wallet</button>
            <button class="btn btn--primary" id="btn-connect"    type="button">Connect Wallet</button>

            <!-- Optional legacy dropdown (still works as fallback) -->
            <div class="wallet__menu" id="wallet-menu" hidden>
              <button data-wallet="phantom">Phantom</button>
              <button data-wallet="solflare">Solflare</button>
              <button data-wallet="backpack">Backpack</button>
            </div>

              <!-- Mobile deep link helper (same ID your JS expects) -->
            <a class="btn btn--outline" id="btn-open-in-phantom" style="display:none" target="_blank" rel="noopener">Open in Phantom</a>
          </div>
          <form class="form" id="bet-form" autocomplete="off">
            <label class="label" for="bet-amount">Wager Amount ($TREATZ)</label>
            <input id="bet-amount" name="amount" type="number" min="0" step="1" placeholder="10,000" inputmode="numeric" />

            <label class="label">Pick a side</label>
            <div class="choices" role="radiogroup" aria-label="Coin side">
              <label class="choice"><input type="radio" name="side" value="TRICK" checked /> TRICKZ üëª</label>
              <label class="choice"><input type="radio" name="side" value="TREAT" /> TREATZ üç¨</label>
            </div>

            <button class="btn btn--primary" type="submit" id="cf-play">Flip that Coin</button>
            <p class="help" id="edge-line">House edge & on-chain fairness info will appear here.</p>

            <!-- Optional: app.js will populate these if present -->
            <div class="help" id="bet-instructions" style="margin-top:.5rem;">
              <div><strong>Deposit:</strong> <code id="bet-deposit">‚Äî</code></div>
              <div><strong>Memo:</strong> <code id="bet-memo">‚Äî</code></div>
            </div>
          </form>
        </div>

        <!-- Visual -->
        <div class="card__col">
          <div class="cf-display" id="cf-display" aria-live="polite">
            <div class="coin" id="coin" aria-label="Coin">
              <div class="coin__face coin__face--front">TRICK</div>
              <div class="coin__face coin__face--back">TREAT</div>
            </div>
            <div class="cf-status" id="cf-status">Ready to flip.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- ============= JACKPOT RAFFLE ============= -->
    <section class="section" id="jackpot" aria-labelledby="jackpot-title">
      <h2 class="section__title" id="jackpot-title">üïØÔ∏è üéÉ Jack'O'Lantern Raffle üéÉ</h2>

      <div class="card grid-3">
        <!-- Stats -->
        <div class="card__col">
          <div class="stats">
            <div>
              <span class="stat__label">Current Pot</span>
              <span class="stat__value"><strong id="round-pot">‚Äî</strong> $TREATZ</span>
            </div>
            <div>
              <span class="stat__label">Round</span>
              <span class="stat__value" id="round-id">‚Äî</span>
            </div>
            <div>
              <span class="stat__label">Closes In</span>
              <span class="stat__value" id="round-countdown">‚Äî</span>
            </div>
            <div>
              <span class="stat__label">Next Draw Starts In</span>
              <span class="stat__value" id="round-next-countdown">‚Äî</span>
            </div>
            <div>
              <span class="stat__label">Ticket Price</span>
              <span class="stat__value"><strong id="ticket-price">‚Äî</strong> $TREATZ</span>
            </div>
          </div>
          <div class="progress" aria-label="Time remaining">
            <div class="progress__bar" id="jp-progress" style="width:0%"></div>
          </div>
          <p id="raffle-schedule" class="help" style="margin-top:.5rem;"></p>
        </div>
        <!-- Inline wallet controls for the game area -->
        <div class="wallet wallet--inline">
          <button class="btn btn--ghost"   id="btn-openwallet" type="button" hidden>Open Wallet</button>
          <button class="btn btn--primary" id="btn-connect"    type="button">Connect Wallet</button>

          <!-- Optional legacy dropdown (still works as fallback) -->
          <div class="wallet__menu" id="wallet-menu" hidden>
            <button data-wallet="phantom">Phantom</button>
            <button data-wallet="solflare">Solflare</button>
            <button data-wallet="backpack">Backpack</button>
          </div>

          <!-- Mobile deep link helper (same ID your JS expects) -->
          <a class="btn btn--outline" id="btn-open-in-phantom" style="display:none" target="_blank" rel="noopener">Open in Phantom</a>
        </div>

        <!-- Buy Tickets -->
        <div class="card__col">
          <div class="form">
            <label class="label" for="jp-amount">Buy Tickets</label>
            <input id="jp-amount" type="number" min="1" step="1" placeholder="1" />
            <button class="btn btn--primary" id="jp-buy" type="button">Enter Raffle</button>
            <p class="help">Tickets recorded on-chain. Auto-payout to winner. % burn to incinerator and gone forever.</p>
          </div>
        </div>

        <!-- Recent Rounds -->
        <div class="card__col">
          <div class="mini-table" aria-live="polite">
            <div class="mini-table__head">
              <span>Recent Rounds</span>
              <button class="btn btn--ghost" id="jp-view-all" type="button">View All</button>
            </div>
            <!-- app.js fills this list from /rounds/recent -->
            <ul class="mini-table__list recent-list" id="recent-rounds"></ul>
          </div> <!-- ‚úÖ close .mini-table -->

          <!-- Player stats (appears when wallet connected) -->
          <div id="player-stats" class="card small" hidden style="margin-top:.75rem;">
            <div><strong>Your tickets (current round):</strong> <span id="ps-tickets">0</span></div>
            <div><strong>Ticket credit:</strong> <span id="ps-credit">0</span> $TREATZ</div>
            <div><strong>Total spent:</strong> <span id="ps-spent">0</span> $TREATZ</div>
            <div><strong>Total winnings:</strong> <span id="ps-won">0</span> $TREATZ</div>
          </div>
        </div>
      </div>
    </section>

    <!-- ============= RAFFLE HISTORY ============= -->
    <section class="section" id="raffle-history" aria-labelledby="raffle-history-title">
      <h2 class="section__title" id="raffle-history-title">Raffle History</h2>
      <div class="card">
        <input id="history-search" type="text" placeholder="Search round (e.g., R1601)" />
        <div class="table-wrap" style="margin-top:.5rem;">
          <table id="history-table">
            <thead>
              <tr>
                <th>Round</th>
                <th>Pot</th>
                <th>Winner</th>
                <th>Payout Tx</th>
                <th>Proof</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- ============= ABOUT ============= -->
    <section class="section" id="about" aria-labelledby="about-title">
      <h2 class="section__title" id="about-title">About $TREATZ</h2>
      <div class="card">
        <p><strong>$TREATZ</strong> is the sweetest Halloween meme coin of Solana ‚Äî bold, spooky, and made for glorious pumps. Just like trick-or-treating, it‚Äôs a dash to fill your bag with candy (and profits). Born from chaos, powered by memes, and dripping with Halloween FOMO ‚Äî $TREATZ is here to haunt the charts, scare the paper hands, and reward the degens brave enough to grab a bag.</p>
        <p>Play our <em>Trick or Treat</em> coin toss and the <em>Jackpot Raffle</em>, track burns and winners in real-time, and help us light the lanterns all the way to October 31.</p>
      </div>
    </section>

    <!-- ============= FOOTER ============= -->
    <footer class="footer">
      <p>¬© 2025 $TREATZ ‚Ä¢ Spooky season never sleeps.</p>
    </footer>
  </main>

  <!-- ==========================
       RENDERED FX LAYER + MASCOT
       ========================== -->
  <div id="fx-layer" aria-hidden="true"></div>
  <img id="mascot-floater" alt="Mascot" />

  <!-- ==========================
       WALLET SELECT MODAL
       ========================== -->
  <div id="wallet-modal" class="wm" hidden>
    <div class="wm__backdrop" data-close></div>
    <div class="wm__card" role="dialog" aria-modal="true" aria-labelledby="wm-title">
      <button class="wm__close" data-close aria-label="Close">√ó</button>
      <h3 id="wm-title">Connect a wallet</h3>
      <p class="wm__sub">Choose a provider to continue.</p>
      <div class="wm__list">
        <button class="wm__item" data-wallet="phantom">
          <span class="wm__icon phantom"></span> Phantom
          <small class="wm__status" data-ph-status>Detected</small>
        </button>
        <button class="wm__item" data-wallet="solflare">
          <span class="wm__icon solflare"></span> Solflare
          <small class="wm__status" data-sf-status>Detected</small>
        </button>
        <button class="wm__item" data-wallet="backpack">
          <span class="wm__icon backpack"></span> Backpack
          <small class="wm__status" data-bp-status>Detected</small>
        </button>
      </div>
      <a id="btn-open-in-phantom-modal" class="wm__deeplink" href="#" target="_blank" rel="noopener" hidden>
        Open site in Phantom
      </a>
      <div class="wm__help">No wallet? <a href="https://phantom.app/" target="_blank" rel="noopener">Install Phantom</a></div>
    </div>
  </div>

</body>
</html>
